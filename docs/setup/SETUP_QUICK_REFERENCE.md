# ðŸš€ Quick Setup Reference Card

## For a New Machine (3 Minutes)

### 1. Clone Repo
```powershell
git clone https://github.com/GarayInvestments/HouseRenoAI.git
cd HouseRenoAI
```

### 2. Install GPG (if not installed)
```powershell
winget install GnuPG.Gpg4win
# Add to PATH
[Environment]::SetEnvironmentVariable("Path", $env:Path + ";C:\Program Files (x86)\GnuPG\bin", "User")
```

### 3. Decrypt Secrets
```powershell
# If first time on new machine, import GPG key
# From old machine: gpg --export-secret-keys steve@garayinvestments.com > private-key.asc
# gpg --import private-key.asc

# Decrypt secrets from Git
.\scripts\git-secret-wrapper.ps1 -Action reveal
```

### 4. Run Automated Setup
```powershell
.\scripts\setup\setup-env.ps1
```

### 5. Start Development
```powershell
# Terminal 1: Backend
.\.venv\Scripts\Activate.ps1
python -m uvicorn app.main:app --reload

# Terminal 2: Frontend
cd frontend
npm install
npm run dev
```

---

## Git-Secret Commands (Primary Method)

### Daily Workflow
```powershell
# After changing .env or credentials
.\scripts\git-secret-wrapper.ps1 -Action hide

# Commit encrypted files
git add .env.secret config/*.secret
git commit -m "Update secrets"
git push

# On another machine / after git pull
.\scripts\git-secret-wrapper.ps1 -Action reveal
```

### One-Time Setup (Already Done)
```powershell
# Initialize (already done)
.\scripts\git-secret-wrapper.ps1 -Action init

# Add yourself
.\scripts\git-secret-wrapper.ps1 -Action tell -Email "your@email.com"

# Track files
.\scripts\git-secret-wrapper.ps1 -Action add -File ".env"
.\scripts\git-secret-wrapper.ps1 -Action add -File "config/house-renovators-credentials.json"
```

### Team Collaboration
```powershell
# Add team member (they share their GPG public key fingerprint)
.\scripts\git-secret-wrapper.ps1 -Action tell -Email "teammate@example.com"

# Re-encrypt so they can decrypt
.\scripts\git-secret-wrapper.ps1 -Action hide
git add *.secret
git commit -m "Add teammate to secrets"
git push
```

---

## Alternative: PowerShell Encryption (No GPG)

If you don't want to use GPG:

```powershell
# Encrypt (password protected)
.\scripts\encrypt-secrets.ps1 -Action encrypt

# Decrypt
.\scripts\encrypt-secrets.ps1 -Action decrypt
```

**Note**: Requires sharing password securely with team.

---

## What's in Git (Encrypted)

### Files Tracked by git-secret:
```
.env.secret                                    # Encrypted environment variables
config/house-renovators-credentials.json.secret  # Encrypted Google Service Account
```

### Configuration Files:
```
.gitsecret/keys                                # GPG key fingerprints
.gitsecret/paths                               # List of tracked files
```

### Still .gitignored (Never Committed):
```
.env                                           # Decrypted env vars
config/house-renovators-credentials.json       # Decrypted credentials
```

---

## Security Checklist

### âœ… Before Pushing Changes:
- [ ] Edit `.env` or credentials as needed
- [ ] Run: `.\scripts\git-secret-wrapper.ps1 -Action hide`
- [ ] Commit `*.secret` files only
- [ ] Verify: `git status` shows NO unencrypted secrets

### âœ… After Pulling Changes:
- [ ] Run: `git pull`
- [ ] Run: `.\scripts\git-secret-wrapper.ps1 -Action reveal`
- [ ] Restart backend if secrets changed

### âœ… New Machine Setup:
- [ ] Clone repo
- [ ] Import GPG private key (one-time)
- [ ] Verify `.gitignore` protects `.env`
- [ ] Verify `config/*.json` protected
- [ ] Run: `git status` (should NOT show secrets)
- [ ] Delete temporary credential files
- [ ] Test backend starts without errors

---

## Environment Variables You Need

### Must Have:
```env
SHEET_ID=your_sheet_id                # From Google Sheets URL
OPENAI_API_KEY=sk-proj-xxx            # From OpenAI dashboard
JWT_SECRET_KEY=random_32_char_string  # Auto-generated by setup script
```

### For QuickBooks Features:
```env
QUICKBOOKS_CLIENT_ID=xxx
QUICKBOOKS_CLIENT_SECRET=xxx
QUICKBOOKS_REDIRECT_URI=http://localhost:8000/v1/quickbooks/callback
```

### File Path:
```env
GOOGLE_SERVICE_ACCOUNT_FILE=config/house-renovators-credentials.json
```

---

## Quick Tests

### Test Backend
```powershell
.\.venv\Scripts\Activate.ps1
python -c "from app.main import app; print('âœ… Backend OK')"
```

### Test Services
```powershell
python -c "from app.services.google_service import google_service; print('âœ… Google OK')"
python -c "from app.services.openai_service import openai_service; print('âœ… OpenAI OK')"
```

### Test Full Startup
```powershell
python -m uvicorn app.main:app --reload
# Should see: Application startup complete
# Visit: http://localhost:8000/docs
```

---

## Common Issues

**"GOOGLE_SERVICE_ACCOUNT_FILE not found"**
â†’ Place JSON in `config/` folder

**"Invalid API key"**
â†’ Check `.env` for typos, no extra spaces

**"Module not found"**
â†’ Activate venv: `.\.venv\Scripts\Activate.ps1`

**"Port 8000 already in use"**
â†’ Kill old process or use `--port 8001`

---

## Production Deployment

After local dev works, secrets go in:
- **Render**: Dashboard â†’ Environment Variables
- **Cloudflare**: Pages â†’ Settings â†’ Environment Variables

DO NOT commit secrets to Git!

---

## Getting Credentials

| Credential | Where to Get It |
|------------|----------------|
| Google Service Account | [Google Cloud Console](https://console.cloud.google.com) â†’ IAM â†’ Service Accounts |
| OpenAI API Key | [OpenAI Platform](https://platform.openai.com/api-keys) |
| QB Client ID/Secret | [QuickBooks Developer](https://developer.intuit.com) â†’ My Apps |
| JWT Secret | Generate: `python -c "import secrets; print(secrets.token_urlsafe(32))"` |
| Sheet ID | From Google Sheets URL: `spreadsheets/d/SHEET_ID/edit` |

---

## Full Documentation

- **Complete Guide**: `docs/SETUP_NEW_MACHINE.md`
- **Troubleshooting**: `docs/TROUBLESHOOTING.md`
- **Security**: `docs/LOGGING_SECURITY.md`
- **API Docs**: `docs/API_DOCUMENTATION.md`

---

Need help? Check the docs or review Render logs:
```powershell
render logs -r srv-d44ak76uk2gs73a3psig --limit 100 --confirm
```
